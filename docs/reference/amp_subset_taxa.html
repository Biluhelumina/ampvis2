<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Subset ampvis2 objects based on taxonomy — amp_subset_taxa • ampvis2</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


<meta property="og:title" content="Subset ampvis2 objects based on taxonomy — amp_subset_taxa" />

<meta property="og:description" content="Subsets the data in ampvis2 objects based on taxonomy and returns the subsetted object." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ampvis2</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.3.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/ampvis2.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/faq.html">FAQ</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MadsAlbertsen/ampvis2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Subset ampvis2 objects based on taxonomy</h1>
    
    <div class="hidden name"><code>amp_subset_taxa.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Subsets the data in ampvis2 objects based on taxonomy and returns the subsetted object.</p>
    
    </div>

    <pre class="usage"><span class='fu'>amp_subset_taxa</span>(<span class='no'>data</span>, <span class='no'>tax_vector</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>(<em>required</em>) Data list as loaded with <code><a href='amp_load.html'>amp_load</a></code>.</p></td>
    </tr>
    <tr>
      <th>tax_vector</th>
      <td><p>(required) A vector with the taxonomic groups with which to perform the subset. The prefixes <code>"k__"</code>, <code>"p__"</code>, <code>"c__"</code>, <code>"o__"</code>, <code>"f__"</code>, <code>"g__"</code>, <code>"s__"</code> indicates their taxonomic rank and the following characters their name (almost always with a capital first letter), e.g. <code>c("p__Chloroflexi","p__Actinobacteria")</code>.</p></td>
    </tr>
    <tr>
      <th>normalise</th>
      <td><p>(<em>logical</em>) <code>BEFORE</code> the subset, transform the OTU read counts to be in percent per sample. (<em>default:</em> <code>FALSE</code>)</p></td>
    </tr>
    <tr>
      <th>remove</th>
      <td><p>(<em>logical</em>) If set to TRUE, then the taxa matching the provided vector will be removed instead of being the only ones kept in the data. (<em>default:</em> <code>FALSE</code>)</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A modifed ampvis2 object</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The taxonomy subset is done by providing a <code>tax_vector</code> of taxa names which are then matched to the taxonomy table, where all other taxa not matching the <code>tax_vector</code> are removed. If <code>remove = TRUE</code>, then the matching taxa are the ones being removed instead. The taxa names in <code>tax_vector</code> will be matched in all columns of the taxonomy table.</p>
    
    <h2 class="hasAnchor" id="preserving-relative-abundances-in-a-subset-of-larger-data"><a class="anchor" href="#preserving-relative-abundances-in-a-subset-of-larger-data"></a>Preserving relative abundances in a subset of larger data</h2>

    
    <p>By default the raw read counts in the abundance matrix are normalised (transformed to percentages) by some plotting functions automatically (for example <code><a href='amp_heatmap.html'>amp_heatmap</a></code>, <code><a href='amp_timeseries.html'>amp_timeseries</a></code>, and more). This means that the relative abundances shown will be calculated based on the remaining taxa after the subset, not including the removed taxa, if any. To circumvent this, set <code>normalise = TRUE</code> when subsetting with the <code>amp_subset_taxa</code> and <code><a href='amp_subset_samples.html'>amp_subset_samples</a></code> functions, and then set <code>raw = TRUE</code> in the plotting function. This will transform the OTU counts to relative abundances BEFORE the subset, and setting <code>raw = TRUE</code> will skip the transformation in the plotting function, see the example below.</p>
<pre>
data("MiDAS")
subsettedData &lt;- amp_subset_samples(MiDAS,
                                    Plant %in% c("Aalborg West", "Aalborg East"),
                                    normalise = TRUE
                                    )
amp_heatmap(subsettedData,
            group_by = "Plant",
            tax_aggregate = "Phylum",
            tax_add = "Genus",
            raw = TRUE
            )
</pre>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='amp_subset_samples.html'>amp_subset_samples</a></code>, <code><a href='amp_heatmap.html'>amp_heatmap</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Load example data</span>
<span class='fu'>data</span>(<span class='st'>"AalborgWWTPs"</span>)

<span class='co'>#An overview heatmap of the data:</span>
<span class='fu'><a href='amp_heatmap.html'>amp_heatmap</a></span>(<span class='no'>AalborgWWTPs</span>,
            <span class='kw'>tax_aggregate</span> <span class='kw'>=</span> <span class='st'>"Genus"</span>,
            <span class='kw'>group_by</span> <span class='kw'>=</span> <span class='st'>"Plant"</span>,
            <span class='kw'>tax_add</span> <span class='kw'>=</span> <span class='st'>"Phylum"</span>
            )</div><div class='img'><img src='amp_subset_taxa-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Remove all taxa except the phyla Chloroflexi and Actinobacteria </span>
<span class='co'>#and the Genera Rhodoferax and Trichococcus:</span>
<span class='no'>tax_vector</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"p__Chloroflexi"</span>,
            <span class='st'>"p__Actinobacteria"</span>,
            <span class='st'>"g__Rhodoferax"</span>,
            <span class='st'>"g__Trichococcus"</span>)

<span class='no'>AalborgWWTPs_subset</span> <span class='kw'>&lt;-</span> <span class='fu'>amp_subset_taxa</span>(<span class='no'>AalborgWWTPs</span>,
                                       <span class='kw'>tax_vector</span> <span class='kw'>=</span> <span class='no'>tax_vector</span>
                                       )</div><div class='output co'>#&gt; <span class='message'>7566 OTUs have been filtered </span>
#&gt; <span class='message'>Before: 9430 OTUs</span>
#&gt; <span class='message'>After: 1864 OTUs</span></div><div class='input'>
<span class='co'>#The resulting subset:</span>
<span class='fu'><a href='amp_heatmap.html'>amp_heatmap</a></span>(<span class='no'>AalborgWWTPs_subset</span>,
            <span class='kw'>tax_aggregate</span> <span class='kw'>=</span> <span class='st'>"Genus"</span>,
            <span class='kw'>group_by</span> <span class='kw'>=</span> <span class='st'>"Plant"</span>,
            <span class='kw'>tax_add</span> <span class='kw'>=</span> <span class='st'>"Phylum"</span>
            )</div><div class='img'><img src='amp_subset_taxa-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Or if remove = TRUE then the taxa in tax_vector are the ones being removed:</span>
<span class='no'>AalborgWWTPs_subset</span> <span class='kw'>&lt;-</span> <span class='fu'>amp_subset_taxa</span>(<span class='no'>AalborgWWTPs</span>,
                                       <span class='kw'>tax_vector</span> <span class='kw'>=</span> <span class='no'>tax_vector</span>,
                                       <span class='kw'>remove</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
                                       )</div><div class='output co'>#&gt; <span class='message'>1864 OTUs have been filtered </span>
#&gt; <span class='message'>Before: 9430 OTUs</span>
#&gt; <span class='message'>After: 7566 OTUs</span></div><div class='input'><span class='co'>#The resulting subset:</span>
<span class='fu'><a href='amp_heatmap.html'>amp_heatmap</a></span>(<span class='no'>AalborgWWTPs_subset</span>,
            <span class='kw'>tax_aggregate</span> <span class='kw'>=</span> <span class='st'>"Genus"</span>,
            <span class='kw'>group_by</span> <span class='kw'>=</span> <span class='st'>"Plant"</span>,
            <span class='kw'>tax_add</span> <span class='kw'>=</span> <span class='st'>"Phylum"</span>
            )</div><div class='img'><img src='amp_subset_taxa-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#preserving-relative-abundances-in-a-subset-of-larger-data">Preserving relative abundances in a subset of larger data</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Kasper Skytte Andersen <a href='mailto:kasperskytteandersen@gmail.com'>kasperskytteandersen@gmail.com</a>

Mads Albertsen <a href='mailto:MadsAlbertsen85@gmail.com'>MadsAlbertsen85@gmail.com</a>

Rasmus Hansen Kirkegaard <a href='mailto:rhk@bio.aau.dk'>rhk@bio.aau.dk</a>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Mads Albertsen, Kasper Skytte Andersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  docsearch({
    
    
    apiKey: 'b0ba3a3eb751685982ccf010113f380a',
    indexName: 'ampvis2',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>

