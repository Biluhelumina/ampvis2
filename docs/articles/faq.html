<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frequently Asked Questions • ampvis2</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Frequently Asked Questions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93913019-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93913019-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ampvis2</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/ampvis2.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/faq.html">FAQ</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MadsAlbertsen/ampvis2">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Frequently Asked Questions</h1>
            
      
      
      <div class="hidden name"><code>faq.Rmd</code></div>

    </div>

    
    
<div id="your-question-here" class="section level2">
<h2 class="hasAnchor">
<a href="#your-question-here" class="anchor"></a>Your question here</h2>
<p>If you have problems or questions, ideas for improvements, or even found a bug or two, feel free to post at <a href="https://github.com/MadsAlbertsen/ampvis2/issues" class="uri">https://github.com/MadsAlbertsen/ampvis2/issues</a> or email one of the developers, anything and everything is welcome.</p>
</div>
<div id="preserving-relative-abundances-in-a-subset-of-larger-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preserving-relative-abundances-in-a-subset-of-larger-data" class="anchor"></a>Preserving relative abundances in a subset of larger data</h2>
<p>By default the raw read counts in the abundance matrix are normalised (transformed to percentages) by some plotting functions automatically (for example <code>amp_heatmap</code>, <code>amp_timeseries</code>, and more). This means that the relative abundances shown will be calculated based on the remaining taxa after the subset, not including the removed taxa, if any. To circumvent this, set <code>normalise = TRUE</code> when subsetting with the <code>amp_subset_taxa</code> and <code>amp_subset_samples</code> functions, and then set <code>raw = TRUE</code> in the plotting function. This will transform the OTU counts to relative abundances BEFORE the subset, and setting <code>raw = TRUE</code> will skip the transformation in the plotting function, see the example below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">data</span>(<span class="st">"MiDAS"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">subsettedData &lt;-<span class="st"> </span><span class="kw"><a href="../reference/amp_subset_samples.html">amp_subset_samples</a></span>(MiDAS,</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">                                    Plant <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">"Aalborg West"</span>, <span class="st">"Aalborg East"</span>),</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                                    <span class="dt">normalise =</span> <span class="ot">TRUE</span> <span class="co">#add this</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                                    )</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="../reference/amp_heatmap.html">amp_heatmap</a></span>(subsettedData,</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">            <span class="dt">group_by =</span> <span class="st">"Plant"</span>,</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">            <span class="dt">tax_aggregate =</span> <span class="st">"Phylum"</span>,</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">            <span class="dt">tax_add =</span> <span class="st">"Genus"</span>,</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">            <span class="dt">normalise =</span> <span class="ot">FALSE</span> <span class="co">#add this</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">            )</a></code></pre></div>
</div>
<div id="custom-distance-matrix-for-use-in-ordination" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-distance-matrix-for-use-in-ordination" class="anchor"></a>Custom distance matrix for use in ordination</h2>
<p>If you wan’t to calculate a distance matrix manually and use it for PCoA or nMDS in <code>amp_ordinate</code>, it can be done quite easily by just setting <code>filter_species = 0</code>, <code>transform = "none"</code>, and <code>distmeasure = "none"</code>, like below. The matrix should be a symmetrical matrix containing coefficients for all pairs of samples in the data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#Override the abundance table in the ampvis2 object with a custom distance matrix</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">ampvis2_object<span class="op">$</span>abund &lt;-<span class="st"> </span>custom_dist_matrix</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#set filter_species = 0, transform = "none", and distmeasure = "none"</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw"><a href="../reference/amp_ordinate.html">amp_ordinate</a></span>(ampvis2_object,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">             <span class="dt">type =</span> <span class="st">"pcoa"</span>,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">             <span class="dt">filter_species =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">             <span class="dt">transform =</span> <span class="st">"none"</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">             <span class="dt">distmeasure =</span> <span class="st">"none"</span>)</a></code></pre></div>
</div>
<div id="loading-phyloseq-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-phyloseq-objects" class="anchor"></a>Loading phyloseq objects</h2>
<p>This is particularly useful if you want to import data in the <strong>QIIME</strong>, <strong>biom</strong>, <strong>mothur</strong>, and <strong>pyrotagger</strong> formats, see the phyloseq <a href="https://joey711.github.io/phyloseq/import-data.html#the_import_family_of_functions">Data Import</a> tutorial. You will first have to extract the OTU-table and the metadata from the phyloseq object, and then import as normal with <code>amp_load</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(ampvis2)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#Combine OTU abundance table and taxonomy table from the phyloseq object "my_phyloseq_object":</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">obj &lt;-<span class="st"> </span>my_phyloseq_object</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">otutable &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">OTU =</span> <span class="kw">rownames</span>(phyloseq<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/phyloseq/topics/otu_table-methods">otu_table</a></span>(obj)<span class="op">@</span>.Data),</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                       phyloseq<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/phyloseq/topics/otu_table-methods">otu_table</a></span>(obj)<span class="op">@</span>.Data,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                       phyloseq<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/phyloseq/topics/tax_table-methods">tax_table</a></span>(obj)<span class="op">@</span>.Data,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                       <span class="dt">check.names =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">                       )</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#Extract metadata from the phyloseq object:</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">metadata &lt;-<span class="st"> </span><span class="kw">data.frame</span>(phyloseq<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/phyloseq/topics/sample_data-methods">sample_data</a></span>(obj), </a>
<a class="sourceLine" id="cb3-12" data-line-number="12">                       <span class="dt">check.names =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">                       )</a>
<a class="sourceLine" id="cb3-14" data-line-number="14"></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#Load the data with amp_load:</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">my_ampvis2_object &lt;-<span class="st"> </span><span class="kw"><a href="../reference/amp_load.html">amp_load</a></span>(otutable, metadata)</a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#your-question-here">Your question here</a></li>
      <li><a href="#preserving-relative-abundances-in-a-subset-of-larger-data">Preserving relative abundances in a subset of larger data</a></li>
      <li><a href="#custom-distance-matrix-for-use-in-ordination">Custom distance matrix for use in ordination</a></li>
      <li><a href="#loading-phyloseq-objects">Loading phyloseq objects</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mads Albertsen, Kasper Skytte Andersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script>
  docsearch({
    
    
    apiKey: 'b0ba3a3eb751685982ccf010113f380a',
    indexName: 'ampvis2',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
